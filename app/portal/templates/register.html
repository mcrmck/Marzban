{% extends "base.html" %}

{% block title %}Generate Account Number{% endblock %}

{% block content %}
<div class="container">
    <h2>Create Your Secure Account</h2>

    <div class="explainer">
        <p>Welcome! Our platform uses a unique <strong>Account Number</strong> for secure access.</p>
        <p>Here's how it works:</p>
        <ul>
            <li>Instead of a username and password, we will generate a unique Account Number for you.</li>
            <li><strong>VERY IMPORTANT:</strong> You are solely responsible for saving this Account Number. Store it securely, like in a password manager.</li>
            <li><strong>If you lose your Account Number, it CANNOT be recovered.</strong> You will permanently lose access to your account and any related data or services.</li>
            <li>This approach prioritizes your privacy by minimizing the personal data we store.</li>
        </ul>
        <p>By clicking the button below, you acknowledge that you understand these terms and the importance of securely storing your Account Number.</p>
    </div>

    {% if generated_account_number %}
        <div class="success-message">
            <h3>Your Account Number Has Been Generated!</h3>
            <p><strong>Please copy and store this number in a safe and secure location IMMEDIATELY.</strong></p>
            <p>Your Account Number: <strong id="accountNumberDisplay">{{ generated_account_number }}</strong>
                <button onclick="copyAccountNumber()" style="margin-left: 10px;">Copy</button>
            </p>
            <p>You will need this number to log in to your account.</p>
            <a href="{{ url_for('login_page') }}" class="button">Proceed to Login</a> </div>
    {% else %}
        {% if error %}
            <p class="error">{{ error }}</p>
        {% endif %}
        <form method="POST" action="{{ url_for('register') }}">
            <button type="submit" class="button-prominent">I Understand and Agree - Generate My Account Number!</button>
        </form>
    {% endif %}
</div>

<script>
    function copyAccountNumber() {
        const accountNumber = document.getElementById('accountNumberDisplay').innerText;
        navigator.clipboard.writeText(accountNumber).then(function() {
            alert('Account Number copied to clipboard!');
        }, function(err) {
            alert('Failed to copy Account Number. Please copy it manually.');
            console.error('Could not copy text: ', err);
        });
    }
</script>
{% endblock %}